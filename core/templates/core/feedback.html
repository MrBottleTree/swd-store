{% extends "core/base.html" %}
{% load static %}
{% block title %}Feedback — SWD Store{% endblock %}

{% block extra_css %}
.form-wrap { max-width: 560px; margin: 0 auto; }
.page-title { font-size: 1.4rem; font-weight: 800; color: var(--navy); margin-bottom: 6px; }
.page-sub { font-size: .875rem; color: var(--muted); margin-bottom: 24px; line-height: 1.6; }

.form-card {
  background: var(--card); border-radius: var(--radius);
  border: 1px solid var(--border); box-shadow: var(--shadow-sm);
  padding: 24px; margin-bottom: 16px;
}
.field-label {
  display: block; font-size: .83rem; font-weight: 700;
  color: var(--navy); margin-bottom: 8px;
}
.field-label .req { color: var(--red); }

textarea {
  width: 100%; padding: 12px 14px;
  border: 1.5px solid var(--border); border-radius: var(--radius-sm);
  font-family: inherit; font-size: .9rem; color: var(--text);
  background: var(--bg); resize: vertical; min-height: 130px;
  transition: border-color .2s;
}
textarea:focus { outline: none; border-color: var(--orange); background: var(--card); }

.field-error { color: var(--red); font-size: .78rem; margin-top: 5px; }

.upload-divider { border: none; border-top: 1px solid var(--border); margin: 20px 0; }

.upload-label-text {
  display: block; font-size: .83rem; font-weight: 700;
  color: var(--navy); margin-bottom: 8px;
}
.upload-label-text .opt { font-weight: 400; color: var(--muted); }

.upload-trigger {
  display: flex; align-items: center; gap: 10px;
  padding: 12px 14px;
  border: 1.5px dashed var(--border); border-radius: var(--radius-sm);
  cursor: pointer; font-size: .85rem; color: var(--muted);
  background: var(--bg); transition: border-color .2s, color .2s;
}
.upload-trigger:hover { border-color: var(--orange); color: var(--orange); }
.upload-trigger i { font-size: 1rem; }

#feedback-preview { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 10px; }
#feedback-preview img {
  width: 64px; height: 64px; object-fit: cover;
  border-radius: 8px; border: 1px solid var(--border);
}

.submit-btn {
  width: 100%; padding: 13px;
  background: var(--orange); color: #fff;
  border: none; border-radius: var(--radius-sm);
  font-family: inherit; font-size: .95rem; font-weight: 700;
  cursor: pointer; transition: background .15s;
}
.submit-btn:hover { background: var(--orange-dark); }
{% endblock %}

{% block content %}
<div class="form-wrap">
  <h1 class="page-title">Send Feedback</h1>
  <p class="page-sub">Help us improve SWD Store. Report bugs, suggest features, or just say hi.</p>

  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="form-card">
      <label class="field-label" for="{{ form.message.id_for_label }}">
        Your message <span class="req">*</span>
      </label>
      <textarea name="message" id="{{ form.message.id_for_label }}" rows="5"
                placeholder="Share your thoughts, suggestions, or report any issues…"
                required>{{ form.message.value|default:'' }}</textarea>
      {% if form.message.errors %}
        <p class="field-error">{{ form.message.errors|join:", " }}</p>
      {% endif %}

      <hr class="upload-divider">

      <span class="upload-label-text">
        Screenshots <span class="opt">(optional)</span>
      </span>
      <label for="feedback-images" class="upload-trigger">
        <i class="fas fa-paperclip"></i> Attach images
      </label>
      <input type="file" id="feedback-images" name="images" accept="image/*" multiple
             style="display:none" onchange="showPreviews(this)">
      <div id="feedback-preview"></div>
    </div>

    <button type="submit" class="submit-btn">Submit Feedback</button>
  </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
function showPreviews(input) {
  var container = document.getElementById('feedback-preview');
  container.innerHTML = '';
  Array.from(input.files).forEach(function(file) {
    var reader = new FileReader();
    reader.onload = function(e) {
      var img = document.createElement('img');
      img.src = e.target.result;
      container.appendChild(img);
    };
    reader.readAsDataURL(file);
  });
}
</script>
{% endblock %}
